(function(){$(function(){var t,n,e,i,r,a;return r=$("#menu_content"),e=$("#menu_form"),n=$("#menus_list"),i=$("#menu_items"),n.nestable(),t={items:n.nestable("serialize")},n.on("change",function(){var e;return e={items:n.nestable("serialize")},JSON.stringify(t)!==JSON.stringify(e)?(r.find("#menu_reoreder_loading").show(),$.post(n.attr("data-reorder_url"),e,function(n){return t=e,r.find("#menu_reoreder_loading").hide(),n?alert(n):void 0})):void 0}),a=function(t){return showLoading(),$.post(n.attr("data-url"),t,function(t){return n.append(t).nestable(),hideLoading()})},i.find(".add_links_to_menu").click(function(){var t,n;return t={items:[],authenticity_token:e.find('[name="authenticity_token"]').val()},n=!1,$(this).closest(".panel").find("input:checkbox:checked").each(function(){return n=!0,t.items.push({id:$(this).val(),kind:$(this).closest(".class_type").attr("data-type")})}).prop("checked",!1),n?(a(t),!1):!1}),i.find(".form-custom-link").submit(function(){var t;return t=$(this),t.valid()?(a({external:t.serializeObject()}),this.reset(),setTimeout(function(){return t.find("label.error").hide()},100),!1):!1}),n.on("click",".item_external",function(){var t;return t=$(this),open_modal({title:t.attr("data-original-title")||t.attr("title"),url:t.attr("href"),mode:"ajax",callback:function(n){var e;return e=n.find("form"),init_form_validations(e),e.submit(function(){return e.valid()?(showLoading(),$.post(e.attr("action"),e.serialize(),function(e){return t.closest("li").replaceWith(e),n.modal("hide"),hideLoading()}),!1):!1})}}),!1}),n.on("click",".delete_menu_item",function(){var t;return t=$(this),confirm(I18n("msg.confirm_del","Are you sure to delete this item?"))?(showLoading(),$.get(t.attr("href"),function(){return t.closest(".dd-item").remove(),hideLoading()}),!1):!1}),r.find(".new_menu_link, .edit_menu_link").ajax_modal({callback:function(t){var n;return n=t.find("form"),setTimeout(function(){return init_form_validations(n)},1e3)}}),r.find("#menu_items #switch_nav_menu_form select").change(function(){return $(this).val()?$(this).closest("form").submit():void 0}),n.on("click",".custom_settings_link",function(){var t;return t=$(this),open_modal({title:t.attr("data-original-title")||t.attr("title"),url:t.attr("href"),mode:"ajax",callback:function(t){var n;return n=t.find("form"),init_form_validations(n),n.submit(function(){return n.valid()?(showLoading(),$.post(n.attr("action"),n.serialize(),function(n){return n&&alert(n),t.modal("hide"),hideLoading()}),!1):!1})}}),!1})})}).call(this);