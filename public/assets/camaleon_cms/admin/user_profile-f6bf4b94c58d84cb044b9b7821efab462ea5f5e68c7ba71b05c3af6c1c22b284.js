jQuery(function(i){function a(){var a=i("#cp_crop"),t=a.find("#crop_image");1===t.length&&(a.find("[name='cp_img_path']").val(t.attr("src")),t.cropper({aspectRatio:1,minWidth:100,minHeight:100,maxWidth:200,maxHeight:200,done:function(i){a.find("[name='ic_x']").val(i.x),a.find("[name='ic_y']").val(i.y),a.find("[name='ic_h']").val(i.height),a.find("[name='ic_w']").val(i.width)}}),i("#cp_accept").prop("disabled",!1).unbind("click").on("click",function(){return i("#modal_change_photo").modal("hide"),showLoading(),i.post(a.attr("action"),a.serialize(),function(a){hideLoading(),i("#user_image").html('<img class="img-thumbnail" src="'+a+"?r="+Math.random()+'"/>')}).error(function(){i.fn.alert({type:"error",content:"Internal Error",title:"Error"})}),i("#cp_accept").prop("disabled",!0),i("#cp_img_path").val(""),i("#cp_target").html(""),!1}))}var t=i("#user_form");t.validate(),i("#profie-form-ajax-password").validate({submitHandler:function(){showLoading();var a=i(this.currentForm);return i.post(a.attr("action"),a.serialize(),function(i){a.flash_message(i)}).complete(function(){hideLoading()}),!1}}),i("#cp_photo").on("click",function(){return i.fn.upload_filemanager({formats:"image",selected:function(t){i("#cp_target").html("<img id='crop_image' src='"+t.url+"' >"),a()},user_pwd:"<%= current_user_pwd %>"}),!1})});